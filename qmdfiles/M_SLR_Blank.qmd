---
title: "Notes L"
subtitle: "Simple Linear Regression"
format:
  html:
    toc: true
    code-overflow: wrap
    code-fold: false
    embed-resources: true
execute: 
  message: FALSE
  warning: FALSE
---

```{r}
#LOAD PACKAGES
library(tidyverse)

#LOAD DATA
power <- read.csv("power.csv")
```

# Motivation

```{r}
power %>% 
  drop_na() %>% 
  ggplot(aes(x=windSpeedRadarTower_m_per_sec, y=power_kW)) + 
  geom_point(pch=16, alpha=0.5, position="jitter") + 
  geom_smooth(method=lm, se=FALSE) +
  labs(x = "Wind Speed (m/s)", y = "Power (kW)") + 
  theme_minimal()
```

# Correlation

Correlation always takes on values between -1 and 1, describes the strength of the linear relationship between two variables. 

![](https://www.mathsisfun.com/data/images/correlation-examples.svg)

```{r}

```

# Correlation Does Not Imply Causation

![](https://matt-rickard.ghost.io/content/images/2022/05/image.png)

![](https://i.stack.imgur.com/TWQaB.jpg)
![](https://miro.medium.com/v2/resize:fit:1200/1*8j7U89RK1SgopIGET0mSFA.png)


# Equations and Interpretation of Coefficients

Want to fit a linear model: 

$$
\hat{y} = b_0 + b_1x
$$

To fit a linear regression model we need the `lm()` function. 

```{r}
#modelname <- lm(y ~ x, data = dataset)

power_model <- lm(power_kW ~ windSpeedRadarTower_m_per_sec,data=power)
summary(power_model)
```

```{r}
#prettier
library(broom)
power_model %>% 
  tidy()
```

To interpret the y-intercept coefficient ($b_0$): 

To interpret the slope coefficient ($b_1$): 




# Assumptions, Residuals, and  Residual Plots 

## Assumptions of Linear Regression: 

- **Linearity:** The relationship between X and the mean of Y is linear -- look at scatterplot
- **Homoscedasticity:** The variance of residual is the same for any value of X -- look at fitted vs. residuals plot
- **Independence:** Observations are independent of each other -- think about context
- **Normality:** For any fixed value of X, Y is normally distributed. -- check the QQ plot


## Check the scatterplot

```{r}
power %>% 
  drop_na() %>% 
  ggplot(aes(x=windSpeedRadarTower_m_per_sec, y=power_kW)) + 
  geom_point(pch=16, alpha=0.5, position="jitter") + 
  geom_smooth(method=lm, se=FALSE) +
  labs(x = "Wind Speed (m/s)", y = "Power (kW)") + 
  theme_minimal()
```

Some examples of nonlinear plots: 

![](https://chartio.com/assets/b32033/tutorials/charts/scatter-plots/a9b8dd5dc2057a70446e5aa32f32b49d54b55f5cabf17a4610e2da94bea7fed5/scatter-plot-example-2.png)

## fitted vs. residuals plot and QQplots

```{r}
library(ggResidpanel)
resid_panel(power_model)
```

The default panel includes the following four plots.

- *Residual Plot* (upper left): This is a plot of the residuals versus predictive values from the model to assess the linearity and constant variance assumptions. 

- *Normal Quantile Plot* (upper right): Also known as a qq-plot, this plot allows us to assess the normality assumption. 

- *Histogram* (lower right): This is a histogram of the residuals with a overlaid normal density curve with mean and standard deviation computed from the residuals. It provides an additional way to check the normality assumption. This plot makes it clear that there is a slight right skew in the residuals from the penguin_model.

- *Index Plot* (lower left): This is a plot of the residuals versus the observation numbers. It can help to find patterns related to the way that the data has been ordered, which may provide insights into additional trends in the data that have not been accounted for in the model.



Some other examples: 

![](https://i.stack.imgur.com/RU17l.png)

![](https://i.ytimg.com/vi/-KXy4i8awOg/maxresdefault.jpg)

# Prediction 

Suppose the radar wind speed is 15 m/s. Use the model above to make a prediction for the amount of power produced. 


```{r}
#predict(power_model, 15)
```


## Interpolation vs. Extrapolation

**Interpolation** is a method of estimating a hypothetical value that exists within a data set.

**Extrapolation** is a method of estimation for hypothetical values that fall outside a data set.

![](https://i.ytimg.com/vi/gbND5b0F8zc/maxresdefault.jpg)


