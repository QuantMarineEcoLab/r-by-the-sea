{
  "hash": "68aa5b42bd5a44fa55ecbb826ed90c3f",
  "result": {
    "markdown": "---\ntitle: \"Notes H\"\nsubtitle: \"`forcats`: for working with categorical variables\"\nauthor: 'EMW'\ndate: 'Friday, June 7, 2024'\nformat:\n  html:\n    toc: true\n    code-overflow: wrap\n    code-fold: false\n    embed-resources: true\nexecute: \n  message: FALSE\n  warning: FALSE\n---\n\n\n\n\nThe R package `forcats` is designed to make working with categorical variables easier and more efficient. It provides a set of functions that allow you to manipulate and analyze categorical data with ease. In this lesson, we'll cover the basics of the `forcats` package and some of its most useful functions.\n\n## Categorical Variables\n\nLet's review what categorical data is. Categorical data is a type of data that consists of categories or labels.\n\nExamples of categorical data include:\n\n- Colors (red, blue, green, etc.)\n- Types of vehicles (sedan, SUV, truck)\n- Educational degrees (high school, college, graduate school)\n\nCategorical data can be further divided into two types: *nominal* and *ordinal*. Nominal data consists of categories that have no inherent order, while ordinal data consists of categories that have a natural order. For example, educational degrees are ordinal data because they can be ordered from least to most advanced.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load packages\nlibrary(tidyverse)\nlibrary(forcats)\n```\n:::\n\n\n\n## Recall: `portal` Rodent Data\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# load data\nportal_rodent <- read.csv(\"https://github.com/weecology/PortalData/raw/main/Rodents/Portal_rodent.csv\")\nportal_species <- read.csv(\"https://raw.githubusercontent.com/weecology/PortalData/main/Rodents/Portal_rodent_species.csv\")\n```\n:::\n\n\nCheck out Kangaroo Rats! \n\n<iframe width=\"560\" height=\"315\" src=\"https://www.youtube.com/embed/-hyKWwiefF8?si=Rvr5XVe3zLFZDFbk\" title=\"YouTube video player\" frameborder=\"0\" allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" referrerpolicy=\"strict-origin-when-cross-origin\" allowfullscreen></iframe>\n\nThere are 4 different kids of kangaroo rats in this dataset: \n\n- Merriam's kangaroo rat (DM)\n- Ord's kangaroo rat (DO)\n- Kangaroo rat (DX)\n- Banner-tailed kangaroo rat (DS)\n\nCreate a dataset called `kangaroo_rat` which has all the data on any kangaroo rats caught in Portal, AZ. You should display the time the rat was captured (year, month, day), the species scientific and common name, and the sex and hindfoot length.  \n\n\n::: {.cell}\n\n```{.r .cell-code}\nkangaroo_rat <- portal_rodent %>% \n  filter(species %in% c(\"DM\", \"DO\", \"DX\", \"DS\")) %>% \n  left_join(portal_species, by = c(\"species\" = \"speciescode\")) %>% \n  select(year, month, day, species, scientificname, commonname, sex, hfl)\n```\n:::\n\n\n\nCreate a line graph showing the number of each species caught in each year. Don't worry about how pretty the labeling is. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nkangaroo_rat %>% \n  group_by(year, commonname) %>% \n  summarize(count=n()) %>% \n  ggplot(aes(x=year, y=count, color=commonname)) + \n  geom_line() + \n  #OPTIONAL\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](H_forcats_Notes_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\nCreate a side-by-side boxplot showing the distribution of hindfoot length between the 4 different species of Kangaroo Rat.  Don't worry about how pretty the labeling is. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nkangaroo_rat %>% \n  ggplot(aes(x=commonname, y=hfl)) + \n  geom_boxplot() + \n  #OPTIONAL + \n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](H_forcats_Notes_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n\nNotice that: \n\n- species, commonname, and sex are all categorical variables or *factors*\n- we notice the factors always display alphabetically. \n\n## Reordering Factor Levels\n\nOne of the most useful functions is `fct_relevel()`, which allows you to reorder the levels of a factor. This can be useful when you want to change the default ordering of the levels or when you want to group certain levels together.\n\nIs `commonname` a factor?  First we need the variables in a very specific factor format (not `chr`)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkangaroo_rat %>% \n    select(commonname) %>% \n    is.factor()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] FALSE\n```\n:::\n:::\n\n\nLet's make it a factor! \n\n\n::: {.cell}\n\n```{.r .cell-code}\nkangaroo_rat <- kangaroo_rat %>% \n  #mutate(species = as.factor(species)) %>% \n  mutate(commonname = as.factor(commonname)) #%>% \n  #mutate(sex = as.factor(sex))\n```\n:::\n\n\nLet's check the levels and their current ordering! \n\n\n::: {.cell}\n\n```{.r .cell-code}\nkangaroo_rat %>% \n  select(commonname) %>% \n  levels()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nNULL\n```\n:::\n\n```{.r .cell-code}\nlevels(kangaroo_rat$commonname)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Banner-tailed kangaroo rat\" \"Kangaroo rat\"              \n[3] \"Merriam's kangaroo rat\"     \"Ord's kangaroo rat\"        \n```\n:::\n:::\n\n\nTo reorder the levels: \n\n\n::: {.cell}\n\n```{.r .cell-code}\nkangaroo_rat  <- kangaroo_rat  %>% \n  mutate(commonname = fct_relevel(commonname, \"Merriam's kangaroo rat\", \"Ord's kangaroo rat\" , \"Banner-tailed kangaroo rat\", \"Kangaroo rat\"))\n\nlevels(kangaroo_rat$commonname)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Merriam's kangaroo rat\"     \"Ord's kangaroo rat\"        \n[3] \"Banner-tailed kangaroo rat\" \"Kangaroo rat\"              \n```\n:::\n:::\n\n\nLet's recreate our boxplot now: \n\n\n::: {.cell}\n\n```{.r .cell-code}\nkangaroo_rat %>% \n  ggplot(aes(x=commonname, y=hfl)) + \n  geom_boxplot() + \n  #OPTIONAL + \n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](H_forcats_Notes_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nRather than reordering them manually by typing the order, you could also re-level by some numeric criteria. For example: \n\n\n::: {.cell}\n\n```{.r .cell-code}\nkangaroo_rat <- kangaroo_rat %>% \n  mutate(commonname = fct_reorder(commonname, hfl, median))\n\nkangaroo_rat %>% \n  ggplot(aes(x=commonname, y=hfl)) + \n  geom_boxplot() + \n  #OPTIONAL + \n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](H_forcats_Notes_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n## Renaming Factor levels\n\nSometimes you might not like the way the levels are named. \nFor example, maybe you feel it's bit redundant to have \"kangaroo rat\" written all the time. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# \"newname\" = \"oldname\"\n\nkangaroo_rat <- kangaroo_rat %>% \n  mutate(commonname = fct_recode(commonname, \"Merriam's\"= \"Merriam's kangaroo rat\", \"Ord's\" = \"Ord's kangaroo rat\" , \"Banner-tailed\" = \"Banner-tailed kangaroo rat\", \"Not specified\" = \"Kangaroo rat\" ))\n\nlevels(kangaroo_rat$commonname)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Not specified\" \"Merriam's\"     \"Ord's\"         \"Banner-tailed\"\n```\n:::\n:::\n",
    "supporting": [
      "H_forcats_Notes_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}